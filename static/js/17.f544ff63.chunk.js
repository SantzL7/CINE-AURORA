"use strict";(self.webpackChunkcine_aurora=self.webpackChunkcine_aurora||[]).push([[17],{17:(e,t,i)=>{i.d(t,{A:()=>v});var r=i(555),o=i(43),s=i(729),a=i(439),n=i(218),l=i(503),d=i(667),c=i(641),u=i(579);const p="https://via.placeholder.com/300x450?text=Sem+Imagem";function m(e){var t;let{series:i,locked:r=!1}=e;const a=(0,n.Zp)(),{currentUser:m}=(0,s.A)(),[h,f]=(0,o.useState)(!1),[v,g]=(0,o.useState)(!1),y=(0,o.useMemo)(()=>({id:(null===i||void 0===i?void 0:i.id)||"",title:(null===i||void 0===i?void 0:i.title)||"S\xe9rie n\xe3o dispon\xedvel",thumbnailUrl:(null===i||void 0===i?void 0:i.thumbnailUrl)||p,genres:Array.isArray(null===i||void 0===i?void 0:i.genres)?i.genres:[],year:(null===i||void 0===i?void 0:i.year)||"",type:(null===i||void 0===i?void 0:i.type)||"series",description:(null===i||void 0===i?void 0:i.description)||""}),[i]),x=(0,o.useCallback)(async()=>{if(null!==m&&void 0!==m&&m.uid&&y.id)try{const e=(0,d.H9)(l.db,"users",m.uid,"watchlist",y.id),t=await(0,d.getDoc)(e);f(t.exists())}catch(e){console.error("Erro ao verificar lista de favoritos:",e),f(!1)}else f(!1)},[m,y.id]);(0,o.useEffect)(()=>{x()},[x]);const b=(0,o.useCallback)(async e=>{if(null===e||void 0===e||e.stopPropagation(),m)if(y.id)try{const e=(0,d.H9)(l.db,"users",m.uid,"watchlist",y.id);h?(await(0,d.kd)(e),f(!1)):(await(0,d.BN)(e,{id:y.id,type:y.type,title:y.title||"S\xe9rie sem t\xedtulo",thumbnailUrl:y.thumbnailUrl||p,addedAt:(new Date).toISOString()}),f(!0))}catch(t){console.error("Erro ao atualizar lista de favoritos:",t)}else console.error("ID da s\xe9rie inv\xe1lido");else a("/login")},[m,h,a,y]),w=(0,o.useCallback)(()=>{y.id?a(r?"/login":"/series/".concat(y.id)):console.error("ID da s\xe9rie inv\xe1lido")},[r,a,y.id]);return(0,u.jsxs)("div",{className:"card",onClick:w,title:y.title,onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),style:{position:"relative",cursor:r?"not-allowed":"pointer",opacity:r?.7:1,transition:"all 0.3s ease",transform:v?"scale(1.05)":"scale(1)",zIndex:v?2:1,width:"200px",minWidth:"200px",height:"auto",borderRadius:"8px",overflow:"hidden",boxShadow:"0 4px 8px rgba(0,0,0,0.2)"},children:[(0,u.jsxs)("div",{style:{position:"relative",width:"100%",paddingTop:"150%"},children:[(0,u.jsx)(c.A,{src:y.thumbnailUrl,alt:"Capa de ".concat(y.title),style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"cover",transition:"transform 0.3s ease"}}),(0,u.jsxs)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"linear-gradient(to top, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0) 50%)",display:"flex",flexDirection:"column",justifyContent:"flex-end",padding:"12px",opacity:v?1:0,transition:"opacity 0.3s ease"},children:[(0,u.jsx)("h3",{style:{color:"#fff",margin:"0 0 8px 0",fontSize:"0.95rem",textShadow:"0 1px 3px rgba(0,0,0,0.6)"},children:y.title}),(0,u.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"auto"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"rgba(255,255,255,0.9)",fontSize:"0.8rem"},children:[y.year&&(0,u.jsx)("span",{children:y.year}),(null===(t=y.genres)||void 0===t?void 0:t[0])&&(0,u.jsxs)("span",{children:["\u2022 ",y.genres[0]]})]}),(0,u.jsx)("button",{onClick:e=>{e.stopPropagation(),b(e)},style:{background:h?"rgba(13, 110, 253, 0.9)":"rgba(0, 0, 0, 0.6)",border:"none",color:"#fff",width:"28px",height:"28px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s ease",fontSize:"1rem",":hover":{transform:"scale(1.1)"}},title:h?"Remover da lista":"Adicionar \xe0 lista",children:h?"\u2713":"+"})]})]})]}),r&&(0,u.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(0,0,0,0.7)",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",pointerEvents:"none"},children:"Fa\xe7a login"})]})}function h(e){let{type:t="text",className:i=""}=e;const r="skeleton ".concat("card"===t?"skeleton-card":"title"===t?"skeleton-title":"skeleton-text"," ").concat(i);return(0,u.jsx)("div",{className:r})}var f=i(204);function v(e){let{title:t,genre:i,type:n="movie",locked:c=!1,watchlist:p=!1,continueWatching:v=!1}=e;const{currentUser:g}=(0,s.A)(),{items:y,loading:x}=function(e){let{genre:t,type:i="movie",watchlist:s=!1,continueWatching:a=!1,currentUser:n}=e;const[c,u]=(0,o.useState)([]),[p,m]=(0,o.useState)(!0),[h,f]=(0,o.useState)(null),v=(0,o.useCallback)(async(e,t)=>{let i=[];try{if(t){const o=(0,d.P)((0,d.rJ)(l.db,e),(0,d._M)("genres","array-contains",t));if(i=(await(0,d.GG)(o)).docs.map(t=>(0,r.A)({id:t.id,type:e},t.data())),0===i.length){const o=(0,d.P)((0,d.rJ)(l.db,e),(0,d._M)("genre","==",t));i=(await(0,d.GG)(o)).docs.map(t=>(0,r.A)({id:t.id,type:e},t.data()))}}else{const t=(0,d.P)((0,d.rJ)(l.db,e),(0,d.AB)(10));i=(await(0,d.GG)(t)).docs.map(t=>(0,r.A)({id:t.id,type:e},t.data()))}}catch(o){console.error("Erro ao buscar itens de ".concat(e,":"),o)}return i},[]);return(0,o.useEffect)(()=>{let e=!0;return async function(){m(!0),f(null);try{if(a){if(!n)return void(e&&u([]));try{let t,s,a=[];try{const[e,i,r]=await Promise.all([(0,d.GG)((0,d.rJ)(l.db,"users",n.uid,"progress")),(0,d.GG)((0,d.rJ)(l.db,"users",n.uid,"watching")),(0,d.getDoc)((0,d.H9)(l.db,"users",n.uid))]);t=e,s=i,a=r.exists()&&r.data().watching||[]}catch(o){console.error("Erro ao buscar itens em andamento:",o),t={docs:[],size:0,empty:!0},s={docs:[],size:0,empty:!0}}const c=[],p=new Set;if(t.docs.forEach(e=>{const t=e.data();c.push((0,r.A)({id:e.id,type:"movie",currentTime:t.currentTime||0,duration:t.duration||0},t))}),s.docs.forEach(e=>{const t=e.data(),i=t.seriesId||e.id.split("-")[0];i&&(p.add(i),c.push((0,r.A)((0,r.A)({id:i,type:"series",currentTime:t.currentTime||0,duration:t.duration||0},t),{},{seriesId:i})))}),a.forEach(e=>{e.seriesId&&(p.has(e.seriesId)||c.push((0,r.A)({id:e.seriesId,type:"series",currentTime:0,duration:0},e)))}),0===c.length)return void(e&&u([]));const m=(i?c.filter(e=>("movies"===e.type?"movie":e.type)===("movies"===i?"movie":i)):c).map(e=>new Promise(async t=>{try{const i="series"===e.type,o=i?"series":"movies",s=i&&e.seriesId||e.id;if(!s)return void t(null);const a=await(0,d.getDoc)((0,d.H9)(l.db,o,s));if(a.exists()){const o=a.data();o.id||(o.id=a.id);const s=e.duration>0?e.currentTime/e.duration:o.duration?e.currentTime/o.duration:0;t((0,r.A)((0,r.A)({id:a.id,type:i?"series":"movies",progress:Math.min(s,.99)},o),{},{currentTime:e.currentTime,duration:e.duration||o.duration},i&&!o.seriesId?{seriesId:a.id}:{}))}else t(null)}catch(o){console.error("Erro ao carregar item:",o),t(null)}})),h=(await Promise.all(m)).filter(Boolean);e&&u(h)}catch(o){console.error("Erro ao carregar itens em andamento:",o),e&&(f(o),u([]))}}else if(s){if(!n)return void(e&&u([]));try{const t=(0,d.rJ)(l.db,"users",n.uid,"watchlist"),o=await(0,d.GG)(t),s=[];for(const e of o.docs){const t=(0,r.A)({id:e.id},e.data());let o=t.type;if("movie"===o&&(o="movies"),(!i||o===i)&&o)try{const e=await(0,d.getDoc)((0,d.H9)(l.db,o,t.id));e.exists()&&s.push((0,r.A)({id:e.id,type:o},e.data()))}catch(c){console.error("Erro ao carregar item ".concat(t.id,":"),c)}}s.sort((e,t)=>(e.title||"").localeCompare(t.title||"")),e&&u(s)}catch(o){console.error("Erro ao carregar lista de favoritos:",o),e&&(f(o),u([]))}}else{let r=[];if("series"===i)r=await v("series",t);else if("movie"===i)r=await v("movies",t);else{const[e,i]=await Promise.all([v("movies",t),v("series",t)]);r=[...e,...i],r.sort((e,t)=>e.title.localeCompare(t.title))}e&&u(r)}}catch(o){console.error("Erro geral ao carregar itens:",o),e&&f(o)}finally{e&&m(!1)}}(),()=>{e=!1}},[t,s,a,n,i,v]),{items:c,loading:p,error:h}}({genre:i,type:n,watchlist:p,continueWatching:v,currentUser:g}),b=(0,o.useRef)(null),[w,j]=(0,o.useState)(!1),[k,A]=(0,o.useState)(!0),S=(0,o.useCallback)(e=>{const t=b.current;if(!t)return;const i="left"===e?-400:400;t.scrollBy({left:i,behavior:"smooth"})},[]),C=(0,o.useCallback)(()=>{const e=b.current;e&&(j(e.scrollLeft>0),A(e.scrollLeft<e.scrollWidth-e.clientWidth-10))},[]);return(0,o.useEffect)(()=>{const e=b.current;if(e)return e.addEventListener("scroll",C),C(),()=>e.removeEventListener("scroll",C)},[y,C]),(0,u.jsxs)("section",{className:"row",children:[(0,u.jsx)("h2",{className:"row__title",children:t}),(0,u.jsxs)("div",{className:"row__container",children:[w&&(0,u.jsx)("button",{className:"nav-button nav-button--left",onClick:()=>S("left"),"aria-label":"Rolar para a esquerda",children:(0,u.jsx)(f._Jj,{})}),(0,u.jsx)("div",{className:"row__scroller",ref:b,children:x?Array.from({length:6}).map((e,t)=>(0,u.jsx)(h,{type:"card"},t)):0===y.length?(0,u.jsx)("div",{className:"row__empty",children:p?"Nenhum item na sua lista":"Nenhum item encontrado"}):y.map(e=>{try{const t="series"===e.type||"series"===n,i=t?m:a.A,o=t?{series:(0,r.A)((0,r.A)({},e),{},{id:e.seriesId||e.id,seriesId:e.seriesId||e.id}),locked:c&&!g}:{movie:(0,r.A)((0,r.A)({},e),{},{id:e.id}),locked:c&&!g},s=t&&e.seriesId||e.id;return(0,u.jsx)(i,(0,r.A)({},o),s)}catch(t){return console.error("Erro ao renderizar item:",t,{item:e}),null}})}),k&&(0,u.jsx)("button",{className:"nav-button nav-button--right",onClick:()=>S("right"),"aria-label":"Rolar para a direita",children:(0,u.jsx)(f.X6T,{})})]})]})}},439:(e,t,i)=>{i.d(t,{A:()=>u});var r=i(218),o=i(43),s=i(729),a=i(503),n=i(667),l=i(641),d=i(579);const c="https://via.placeholder.com/300x450?text=Sem+Imagem";function u(e){var t;let{movie:i,locked:u=!1}=e;const p=(0,r.Zp)(),{currentUser:m}=(0,s.A)(),[h,f]=(0,o.useState)(!1),[v,g]=(0,o.useState)(!1),y=(0,o.useMemo)(()=>({id:(null===i||void 0===i?void 0:i.id)||"",title:(null===i||void 0===i?void 0:i.title)||"Filme n\xe3o dispon\xedvel",thumbnailUrl:(null===i||void 0===i?void 0:i.thumbnailUrl)||c,genres:Array.isArray(null===i||void 0===i?void 0:i.genres)?i.genres:[],year:(null===i||void 0===i?void 0:i.year)||"",description:(null===i||void 0===i?void 0:i.description)||"",type:"movie"}),[i]),x=(0,o.useCallback)(async()=>{if(null!==m&&void 0!==m&&m.uid&&y.id)try{const e=(0,n.H9)(a.db,"users",m.uid,"watchlist",y.id),t=await(0,n.getDoc)(e);f(t.exists())}catch(e){console.error("Erro ao verificar lista de favoritos:",e),f(!1)}else f(!1)},[m,y.id]);(0,o.useEffect)(()=>{x()},[x]);const b=(0,o.useCallback)(async e=>{if(null===e||void 0===e||e.stopPropagation(),m)if(y.id)try{const e=(0,n.H9)(a.db,"users",m.uid,"watchlist",y.id);h?(await(0,n.kd)(e),f(!1)):(await(0,n.BN)(e,{id:y.id,type:y.type,title:y.title||"Filme sem t\xedtulo",thumbnailUrl:y.thumbnailUrl||c,addedAt:(new Date).toISOString()}),f(!0))}catch(t){console.error("Erro ao atualizar lista de favoritos:",t)}else console.error("ID do filme inv\xe1lido");else p("/login")},[m,h,p,y]),w=(0,o.useCallback)(()=>{u?p("/login"):y.id&&p("/title/".concat(y.id))},[u,p,y.id]);return(0,d.jsxs)("div",{className:"card",onClick:w,title:y.title,onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),style:{position:"relative",cursor:u?"not-allowed":"pointer",opacity:u?.7:1,transition:"all 0.3s ease",transform:v?"scale(1.05)":"scale(1)",zIndex:v?2:1,width:"200px",minWidth:"200px",height:"auto",borderRadius:"8px",overflow:"hidden",boxShadow:"0 4px 8px rgba(0,0,0,0.2)"},children:[(0,d.jsxs)("div",{style:{position:"relative",width:"100%",paddingTop:"150%"},children:[(0,d.jsx)(l.A,{src:y.thumbnailUrl,alt:"Capa de ".concat(y.title),style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"cover",transition:"transform 0.3s ease"}}),(0,d.jsxs)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"linear-gradient(to top, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0) 50%)",display:"flex",flexDirection:"column",justifyContent:"flex-end",padding:"12px",opacity:v?1:0,transition:"opacity 0.3s ease"},children:[(0,d.jsx)("h3",{style:{color:"#fff",margin:"0 0 8px 0",fontSize:"0.95rem",textShadow:"0 1px 3px rgba(0,0,0,0.6)"},children:y.title}),(0,d.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"auto"},children:[(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"rgba(255,255,255,0.9)",fontSize:"0.8rem"},children:[y.year&&(0,d.jsx)("span",{children:y.year}),(null===(t=y.genres)||void 0===t?void 0:t[0])&&(0,d.jsxs)("span",{children:["\u2022 ",y.genres[0]]})]}),(0,d.jsx)("button",{onClick:e=>{e.stopPropagation(),b(e)},style:{background:h?"rgba(13, 110, 253, 0.9)":"rgba(0, 0, 0, 0.6)",border:"none",color:"#fff",width:"28px",height:"28px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s ease",fontSize:"1rem"},title:h?"Remover da lista":"Adicionar \xe0 lista",onMouseEnter:e=>{h&&(e.currentTarget.innerHTML="\xd7",e.currentTarget.style.transform="scale(1.1)")},onMouseLeave:e=>{h&&(e.currentTarget.innerHTML="\u2713",e.currentTarget.style.transform="scale(1)")},children:h?"\u2713":"+"})]})]})]}),u&&(0,d.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(0,0,0,0.7)",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",pointerEvents:"none"},children:"Fa\xe7a login"})]})}},641:(e,t,i)=>{i.d(t,{A:()=>l});var r=i(555),o=i(986),s=i(43),a=i(579);const n=["src","alt","className","style"];function l(e){let{src:t,alt:i,className:l,style:d}=e,c=(0,o.A)(e,n);const[u,p]=(0,s.useState)(!1),[m,h]=(0,s.useState)(!1);return(0,a.jsx)("div",{style:(0,r.A)({position:"relative",overflow:"hidden",backgroundColor:"#222"},d),className:l,children:(0,a.jsx)("img",(0,r.A)({src:u?"https://via.placeholder.com/300x450?text=Sem+Imagem":t,alt:i,loading:"lazy",onError:()=>{p(!0)},onLoad:()=>{h(!0)},style:{width:"100%",height:"100%",objectFit:"cover",opacity:m?1:0,transition:"opacity 0.3s ease-in-out",display:"block"}},c))})}}}]);
//# sourceMappingURL=17.f544ff63.chunk.js.map