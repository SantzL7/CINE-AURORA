"use strict";(self.webpackChunkcine_aurora=self.webpackChunkcine_aurora||[]).push([[531],{531:(e,o,r)=>{r.r(o),r.d(o,{default:()=>m});var n=r(555),t=r(43),a=r(163),i=r(667),s=r(441),l=r(729),c=r(840);const d=e=>{if(!e)return null;if(e.includes("drive.google.com"))try{let o="";const r=e.match(/\/file\/d\/([\w-]+)/),n=e.match(/[&?]id=([\w-]+)/),t=e.match(/^[\w-]{25,}$/);if(r&&r[1])o=r[1];else if(n&&n[1])o=n[1];else{if(!t)return console.warn("N\xe3o foi poss\xedvel extrair o ID do arquivo do Google Drive:",e),e;o=t[0]}console.log("ID do arquivo extra\xeddo:",o);const a=["https://drive.google.com/uc?export=view&id=".concat(o),"https://drive.google.com/file/d/".concat(o,"/preview"),"https://drive.google.com/uc?export=download&id=".concat(o),"https://drive.google.com/uc?id=".concat(o),"https://docs.google.com/uc?export=download&id=".concat(o),"https://drive.google.com/uc?export=media&id=".concat(o),e];return console.log("URLs que ser\xe3o tentadas:",a),a}catch(o){return console.error("Erro ao processar link do Google Drive:",o),e}return e};var u=r(579);const p=e=>{if(!e)return"";const o=e.match(/\/file\/d\/([\w-]+)/);if(o&&o[1])return o[1];const r=e.match(/[&?]id=([\w-]+)/);if(r&&r[1])return r[1];const n=e.match(/^[\w-]{25,}$/);return n?n[0]:""};function m(){var e;const{id:o,type:r="movie"}=(0,a.g)(),m=(0,a.Zp)(),[h,v]=(0,t.useState)(null),{currentUser:f}=(0,l.A)(),g=(0,t.useRef)(null),[b,x]=(0,t.useState)(!0),[y,k]=(0,t.useState)(0),[j,_]=(0,t.useState)([]),w=(0,t.useCallback)(async()=>{if(o)try{const e="series"===r?"series":"movies",t=(0,i.H9)(s.db,e,o),a=await(0,i.getDoc)(t);if(a.exists()){const e=(0,n.A)({id:a.id,type:r},a.data());return v(e),e}return console.error("M\xeddia n\xe3o encontrada:",{id:o,type:r}),m("/app",{replace:!0}),null}catch(e){return console.error("Erro ao carregar m\xeddia:",e),m("/app",{replace:!0}),null}},[o,r,m]),C=(0,t.useCallback)(async e=>{if(!e||"series"!==e.type)return null;try{const e=(0,i.rJ)(s.db,"series/".concat(o,"/seasons")),r=(0,i.P)(e,(0,i.My)("number","asc")),n=await(0,i.GG)(r);if(n.empty)return null;const t=n.docs[0],a=t.data().number||1,l=(0,i.rJ)(s.db,"series/".concat(o,"/seasons/").concat(t.id,"/episodes")),c=(0,i.P)(l,(0,i.My)("number","asc")),d=await(0,i.GG)(c);if(d.empty)return null;const u=d.docs[0];return{seasonNumber:a,episodeNumber:u.data().number||1}}catch(r){return console.error("Erro ao carregar primeiro epis\xf3dio:",r),null}},[o]);return(0,t.useEffect)(()=>{if(!h)return;const e=Array.isArray(h.videoUrl)?h.videoUrl:[h.videoUrl];if(h.videoUrl&&"string"===typeof h.videoUrl&&h.videoUrl.includes("drive.google.com")){const e=d(h.videoUrl);_(Array.isArray(e)?e:[e])}else _(e);k(0)},[h]),(0,t.useEffect)(()=>{(async()=>{try{x(!0);const e=await w();if("series"===(null===e||void 0===e?void 0:e.type)){const r=await C(e);if(r)return void m("/watch/series/".concat(o,"/season/").concat(r.seasonNumber,"/episode/").concat(r.episodeNumber),{replace:!0})}}catch(e){console.error("Erro na inicializa\xe7\xe3o:",e),m("/app",{replace:!0})}finally{x(!1)}})()},[w,C,o,m]),(0,t.useEffect)(()=>{if(!f||!h)return;const e=g.current;if(!e)return;let o=0,r=!0;const n=async()=>{if(!r||!e.duration)return;const n=Date.now();if(!(n-o<5e3)){o=n;try{const o=(0,i.H9)(s.db,"users",f.uid,"progress",h.id);await(0,i.BN)(o,{currentTime:e.currentTime,duration:e.duration,type:h.type,updatedAt:new Date})}catch(t){console.error("Erro ao salvar progresso:",t)}}};return e.addEventListener("timeupdate",n),()=>{r=!1,e.removeEventListener("timeupdate",n)}},[f,h]),b||!h?(0,u.jsx)("div",{style:{backgroundColor:"#0f0f0f",minHeight:"100vh",color:"#fff",display:"flex",justifyContent:"center",alignItems:"center",fontSize:"1.2rem"},children:(0,u.jsxs)("div",{children:["Carregando ","series"===r?"s\xe9rie":"filme","..."]})}):(0,u.jsxs)("div",{style:{backgroundColor:"#0f0f0f",minHeight:"100vh",color:"#fff"},children:[(0,u.jsx)(c.A,{}),(0,u.jsx)("main",{style:{padding:"20px 5%",maxWidth:"1400px",margin:"0 auto",paddingTop:"80px"},children:(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[(0,u.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:(0,u.jsx)("button",{onClick:()=>m(-1),style:{backgroundColor:"rgba(255, 255, 255, 0.1)",border:"none",color:"#fff",padding:"10px 20px",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s ease"},onMouseOver:e=>{e.target.style.backgroundColor="rgba(255, 255, 255, 0.2)"},onMouseOut:e=>{e.target.style.backgroundColor="rgba(255, 255, 255, 0.1)"},children:"\u2190 Voltar"})}),(0,u.jsx)("div",{style:{width:"100%",maxHeight:"70vh",backgroundColor:"#000",borderRadius:"8px",overflow:"hidden",position:"relative",paddingTop:"56.25%"},children:null!==h&&void 0!==h&&null!==(e=h.videoUrl)&&void 0!==e&&e.includes("drive.google.com")?(0,u.jsx)("iframe",{src:"https://drive.google.com/file/d/".concat(p(h.videoUrl),"/preview"),width:"100%",height:"100%",allow:"autoplay",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",border:"none",backgroundColor:"#000"},title:"Player de v\xeddeo",allowFullScreen:!0}):j.length>0?(0,u.jsx)("video",{ref:g,src:j[y],controls:!0,autoPlay:!0,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",outline:"none",display:"block",backgroundColor:"#000"},onError:e=>{console.error("Erro ao carregar o v\xeddeo:",e),y<j.length-1?(console.log("Tentando pr\xf3xima fonte de v\xeddeo..."),k(e=>e+1)):console.error("Todas as fontes de v\xeddeo falharam")},onLoadedData:()=>{console.log("V\xeddeo carregado com sucesso:",j[y])}},"video-".concat(y)):(0,u.jsxs)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"#111",color:"#fff",padding:"20px",textAlign:"center"},children:[(0,u.jsx)("div",{style:{fontSize:"2rem",marginBottom:"10px"},children:"\ud83d\udeab"}),(0,u.jsx)("h3",{children:"V\xeddeo n\xe3o dispon\xedvel"}),(0,u.jsx)("p",{children:"O v\xeddeo solicitado n\xe3o p\xf4de ser carregado."}),(0,u.jsx)("button",{onClick:()=>m(-1),style:{marginTop:"20px",padding:"10px 20px",backgroundColor:"#e50914",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"1rem"},children:"Voltar"})]})}),(0,u.jsxs)("div",{style:{padding:"0 20px",maxWidth:"1000px",margin:"0 auto",textAlign:"center"},children:[(0,u.jsxs)("h1",{style:{fontSize:"2rem",margin:"0 0 10px 0",color:"#fff",display:"flex",alignItems:"center",gap:"10px",flexWrap:"wrap"},children:[h.title,h.year&&(0,u.jsxs)("span",{style:{fontSize:"1.2rem",color:"#999",fontWeight:"normal"},children:["(",h.year,")"]})]}),h.description&&(0,u.jsx)("p",{style:{fontSize:"1.1rem",lineHeight:"1.7",color:"rgba(255, 255, 255, 0.85)",margin:"0 auto",maxWidth:"800px"},children:h.description})]})]})})]})}},840:(e,o,r)=>{r.d(o,{A:()=>s});var n=r(43),t=r(163),a=r(729),i=r(579);function s(){const[e,o]=(0,n.useState)(!1),[r,s]=(0,n.useState)(!1),l=(0,t.Zp)(),c=(0,t.zy)(),{currentUser:d,logout:u}=(0,a.A)();async function p(){try{await u(),l("/login",{replace:!0})}catch(e){console.error(e)}}(0,n.useEffect)(()=>{function e(){o(window.scrollY>10)}return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),(0,n.useEffect)(()=>{s(!1)},[c]);const m=e=>{l(e),s(!1)};return(0,i.jsxs)("header",{className:"navbar".concat(e?" navbar--scrolled":""),children:[(0,i.jsxs)("div",{className:"navbar__brand",onClick:()=>m("/app"),style:{cursor:"pointer",display:"flex",alignItems:"center",gap:"10px"},children:[(0,i.jsx)("img",{src:"/logo192.png",alt:"Logo CineAurora",style:{height:"40px",width:"auto"}}),(0,i.jsx)("span",{style:{fontWeight:"bold",fontSize:"1.2rem"},children:"CineAurora"})]}),(0,i.jsxs)("nav",{className:"navbar__nav",children:[(0,i.jsx)("button",{className:"navbar__link".concat("/app"!==c.pathname||c.search?"":" navbar__link--active"),onClick:()=>l("/app"),children:"Home"}),(0,i.jsx)("button",{className:"navbar__link".concat("?type=movie"===c.search?" navbar__link--active":""),onClick:()=>l("/app?type=movie"),children:"Filmes"}),(0,i.jsx)("button",{className:"navbar__link".concat("?type=series"===c.search?" navbar__link--active":""),onClick:()=>l("/app?type=series"),children:"S\xe9ries"}),(0,i.jsx)("button",{className:"navbar__link".concat("/my-list"===c.pathname?" navbar__link--active":""),onClick:()=>l("/my-list"),children:"Minha lista"})]}),(0,i.jsxs)("div",{className:"navbar__right",children:["matheus0mendes0marinho@gmail.com"===(null===d||void 0===d?void 0:d.email)&&(0,i.jsx)("button",{className:"btn",type:"button",onClick:()=>l("/admin"),children:"Admin"}),(0,i.jsx)("button",{className:"navbar__icon","aria-label":"Buscar",onClick:()=>l("/search"),children:"\ud83d\udd0d"}),(0,i.jsx)("button",{className:"btn",onClick:p,children:"Sair"})]}),(0,i.jsxs)("button",{className:"navbar__mobile-toggle ".concat(r?"open":""),onClick:()=>s(!r),"aria-label":"Menu",children:[(0,i.jsx)("span",{}),(0,i.jsx)("span",{}),(0,i.jsx)("span",{})]}),(0,i.jsxs)("div",{className:"navbar__mobile-menu ".concat(r?"open":""),children:[(0,i.jsx)("button",{className:"navbar__mobile-link",onClick:()=>m("/app"),children:"Home"}),(0,i.jsx)("button",{className:"navbar__mobile-link",onClick:()=>m("/app?type=movie"),children:"Filmes"}),(0,i.jsx)("button",{className:"navbar__mobile-link",onClick:()=>m("/app?type=series"),children:"S\xe9ries"}),(0,i.jsx)("button",{className:"navbar__mobile-link",onClick:()=>m("/my-list"),children:"Minha lista"}),"matheus0mendes0marinho@gmail.com"===(null===d||void 0===d?void 0:d.email)&&(0,i.jsx)("button",{className:"navbar__mobile-link",onClick:()=>m("/admin"),children:"Admin"}),(0,i.jsx)("button",{className:"navbar__mobile-link",onClick:()=>{p(),s(!1)},style:{color:"#ef4444"},children:"Sair"})]})]})}}}]);
//# sourceMappingURL=531.8e8f8b69.chunk.js.map